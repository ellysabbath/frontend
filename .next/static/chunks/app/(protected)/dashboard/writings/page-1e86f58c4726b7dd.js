(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{7692:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>r});var s=l(5155),o=l(2115),a=l(4752),n=l.n(a);let i="https://bahifinal.pythonanywhere.com/",r=()=>{let[e,t]=(0,o.useState)([]),[l,a]=(0,o.useState)(!1),[r,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)(null),[h,x]=(0,o.useState)(!1),[m,f]=(0,o.useState)({title:"",file:null}),[p,w]=(0,o.useState)(""),[g,b]=(0,o.useState)(!1),v=(0,o.useRef)(null),j=(0,o.useRef)(null),N=()=>{var e;let t={"X-CSRFToken":(null==(e=document.cookie.split("; ").find(e=>e.startsWith("csrftoken=")))?void 0:e.split("=")[1])||""},l=localStorage.getItem("access_token");return l&&(t.Authorization="Bearer ".concat(l)),t},k=(0,o.useCallback)(async()=>{a(!0),b(!0);try{let e=await fetch("".concat(i,"books/"),{headers:N()});if(!e.ok)throw Error("Failed to fetch books");let l=await e.json();t(l)}catch(e){n().fire({icon:"error",title:"Error",text:e.message,position:"center",showConfirmButton:!1,timer:3e3})}finally{a(!1),b(!1)}},[]);(0,o.useEffect)(()=>{k()},[k]);let C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u(e),f(e?{title:e.title,file:null}:{title:"",file:null}),x(!0),b(!0)},y=()=>{x(!1),u(null),b(!1),j.current&&(j.current.value="")},B=async function(e,t,l){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={method:e,headers:N()};l&&!s?(o.headers={...o.headers,"Content-Type":"application/json"},o.body=JSON.stringify(l)):l&&s&&(o.body=l);let a=await fetch("".concat(i).concat(t),o);if(!a.ok)throw Error(await a.text()||"Request failed");return 204===a.status?null:await a.json()},S=async e=>{if(e.preventDefault(),m.title&&(d||m.file)){c(!0);try{let e=new FormData;e.append("title",m.title),m.file&&e.append("book_file",m.file),d?(await B("PUT","books/".concat(d.id,"/"),e,!0),n().fire({icon:"success",title:"Book Updated Successfully!",position:"center",showConfirmButton:!1,timer:3e3})):(await B("POST","books/",e,!0),n().fire({icon:"success",title:"Book Uploaded Successfully!",position:"center",showConfirmButton:!1,timer:3e3})),y(),k()}catch(e){n().fire({icon:"error",title:"Error",text:e.message,position:"center",showConfirmButton:!1,timer:3e3})}finally{c(!1)}}},R=async e=>{if((await n().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",position:"center",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){c(!0);try{await B("DELETE","books/".concat(e,"/")),n().fire({icon:"success",title:"Book Deleted Successfully!",position:"center",showConfirmButton:!1,timer:3e3}),k()}catch(e){n().fire({icon:"error",title:"Error",text:e.message,position:"center",showConfirmButton:!1,timer:3e3})}finally{c(!1)}}},z=e=>{let t=document.createElement("a");t.href=e.book_file,t.download=e.title,document.body.appendChild(t),t.click(),document.body.removeChild(t)},E=e=>window.open(e.book_file,"_blank"),L=e.filter(e=>e.title.toLowerCase().includes(p.toLowerCase())),M=e=>new Date(e).toLocaleDateString();return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:[(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("header",{className:"mb-6 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-slate-800 mb-2",children:"Book Library"}),(0,s.jsx)("p",{className:"text-slate-600",children:"Manage your digital book collection"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden mb-6",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search books...",value:p,onChange:e=>w(e.target.value),className:"border px-4 py-2 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-slate-500"}),(0,s.jsxs)("button",{onClick:()=>C(),className:"bg-slate-800 text-white px-4 py-2 rounded-lg hover:bg-slate-900 transition-colors flex items-center gap-2 w-full sm:w-auto justify-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Add Book"]})]}),l||g?(0,s.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-slate-800"})}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-slate-800 text-white",children:[(0,s.jsx)("th",{className:"p-4 text-left font-semibold rounded-tl-lg",children:"Title"}),(0,s.jsx)("th",{className:"p-4 text-left font-semibold",children:"Date Added"}),(0,s.jsx)("th",{className:"p-4 text-center font-semibold rounded-tr-lg",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:0===L.length?(0,s.jsx)("tr",{children:(0,s.jsxs)("td",{colSpan:3,className:"p-8 text-center text-gray-500",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-slate-300 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),(0,s.jsx)("p",{children:"No books found"})]})}):L.map((e,t)=>(0,s.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors ".concat(t===L.length-1?"":"border-b"),children:[(0,s.jsx)("td",{className:"p-4 text-slate-800 font-medium",children:e.title}),(0,s.jsx)("td",{className:"p-4 text-slate-600",children:M(e.date_uploaded)}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>z(e),className:"p-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors flex items-center gap-1",title:"Download",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,s.jsx)("button",{onClick:()=>E(e),className:"p-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors flex items-center gap-1",title:"Read",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,s.jsx)("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),(0,s.jsx)("button",{onClick:()=>C(e),className:"p-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors flex items-center gap-1",title:"Edit",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),(0,s.jsx)("button",{onClick:()=>R(e.id),className:"p-2 bg-slate-100 text-red-600 rounded-lg hover:bg-red-50 transition-colors flex items-center gap-1",disabled:r,title:"Delete",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})})]},e.id))})]})})]}),(0,s.jsxs)("div",{className:"text-center text-slate-700 bg-white p-3 rounded-lg shadow",children:["Total Books: ",(0,s.jsx)("span",{className:"font-bold",children:e.length})]})]}),h&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{ref:v,className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[(0,s.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-slate-800 flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),d?"Edit Book":"Upload New Book"]}),(0,s.jsxs)("form",{onSubmit:S,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-medium mb-1 text-slate-700",children:"Title:"}),(0,s.jsx)("input",{type:"text",name:"title",value:m.title,onChange:e=>f(t=>({...t,[e.target.name]:e.target.value})),className:"w-full border px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",required:!0})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-medium mb-1 text-slate-700",children:d?"Replace File (optional):":"Book File:"}),(0,s.jsx)("input",{type:"file",ref:j,onChange:e=>{e.target.files&&e.target.files[0]&&f(t=>({...t,file:e.target.files[0]}))},className:"w-full border px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",accept:".pdf,.epub,.mobi,.txt",required:!d})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"submit",disabled:r,className:"flex-1 bg-slate-800 text-white py-2 rounded-lg hover:bg-slate-900 transition-colors flex items-center justify-center gap-2",children:r?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Update"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload"]})}),(0,s.jsx)("button",{type:"button",onClick:y,disabled:r,className:"flex-1 bg-slate-100 text-slate-700 py-2 rounded-lg hover:bg-slate-200 transition-colors",children:"Cancel"})]})]})]})})]})}},9076:(e,t,l)=>{Promise.resolve().then(l.bind(l,7692))}},e=>{var t=t=>e(e.s=t);e.O(0,[320,441,684,358],()=>t(9076)),_N_E=e.O()}]);