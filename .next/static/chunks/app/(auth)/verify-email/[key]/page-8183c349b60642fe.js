(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[851],{1886:(e,r,t)=>{"use strict";t.d(r,{A:()=>c});var n=t(9483),s=t(3464),i=t(7383);let o="https://bahifinal.pythonanywhere.com/api/auth",a=s.A.create({baseURL:o,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let r=i.A.get(n.X);return r&&e.headers&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var r;let t=e.config;if((null==(r=e.response)?void 0:r.status)===401&&!t._retry){t._retry=!0;let e=i.A.get(n.a);if(e)try{let{data:r}=await s.A.post("".concat(o,"/token/refresh/"),{refresh:e}),c=r.access;return i.A.set(n.X,c,{sameSite:"Strict"}),t.headers.Authorization="Bearer ".concat(c),a(t)}catch(e){i.A.remove(n.X),i.A.remove(n.a),window.location.href="/login"}}return Promise.reject(e)});let c=a},5695:(e,r,t)=>{"use strict";var n=t(8999);t.o(n,"redirect")&&t.d(r,{redirect:function(){return n.redirect}}),t.o(n,"useParams")&&t.d(r,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}})},6940:(e,r,t)=>{Promise.resolve().then(t.bind(t,9147))},7383:(e,r,t)=>{"use strict";function n(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)e[n]=t[n]}return e}t.d(r,{A:()=>s});var s=function e(r,t){function s(e,s,i){if("undefined"!=typeof document){"number"==typeof(i=n({},t,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var a in i)i[a]&&(o+="; "+a,!0!==i[a]&&(o+="="+i[a].split(";")[0]));return document.cookie=e+"="+r.write(s,e)+o}}return Object.create({set:s,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},s=0;s<t.length;s++){var i=t[s].split("="),o=i.slice(1).join("=");try{var a=decodeURIComponent(i[0]);if(n[a]=r.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,r){s(e,"",n({},r,{expires:-1}))},withAttributes:function(r){return e(this.converter,n({},this.attributes,r))},withConverter:function(r){return e(n({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(r)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},7446:(e,r,t)=>{"use strict";t.d(r,{u:()=>o});var n=t(9483),s=t(7383),i=t(1886);let o={register:async e=>{try{return(await i.A.post("".concat("","/register/"),e)).data}catch(e){console.log("Error in AuthService.register:",e)}},login:async(e,r)=>{try{let t=await i.A.post("".concat("","/login/"),{email:e,password:r});if(200===t.status){let{access:e,refresh:r}=t.data,i={expires:1,secure:!0};return s.A.set(n.X,e,i),s.A.set(n.a,r,{...i,expires:7}),t.data}}catch(e){console.log("Error in AuthService.login: ",e)}},verifyEmail:async e=>{try{let r=await i.A.get("".concat("","/verify-email/").concat(e,"/"));if(200===r.status){let{access:e,refresh:t}=r.data,i={expires:1,secure:!0};return s.A.set(n.X,e,i),s.A.set(n.a,t,{...i,expires:7}),r.data}}catch(e){return console.log("Error in AuthService.sendVerificationEmail:",e),{error:e instanceof Error?e.message:"An error occurred while verifying email"}}},resendVerificationEmail:async e=>{try{let r=await i.A.post("".concat("","/resend-verification-email/"),{email:e});if(200===r.status)return r.data}catch(e){console.log("Error in AuthService.resendVerificationEmail:",e)}},getUserProfile:async()=>{try{return(await i.A.get("".concat("","/profile/"))).data}catch(e){console.log("Error in AuthService.getUserProfile:",e)}},logout:async()=>{try{let e=await i.A.post("".concat("","/logout/"),{refresh_token:s.A.get(n.a)});return s.A.remove(n.X),s.A.remove(n.a),e.data}catch(e){console.log("Error in AuthService.logout:",e),s.A.remove(n.X),s.A.remove(n.a)}}}},9147:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var n=t(5155),s=t(7446),i=t(5695),o=t(2115);let a=()=>{let{key:e}=(0,i.useParams)(),[r,t]=(0,o.useState)("verifying"),[a,c]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(!e)return t("error");(async()=>{t("verifying");let r=await s.u.verifyEmail(e);if(null==r?void 0:r.error){var n;t("error"),c((null==(n=r.error)?void 0:n.message)||"An error occurred while verifying your email");return}(null==r?void 0:r.message)&&(null==r?void 0:r.access)&&r.refresh&&r.user&&(t("success"),setTimeout(()=>{window.location.href="/dashboard"},2e3))})()},[e]),(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,n.jsxs)("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md",children:["verifying"===r&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"flex justify-center mb-4",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-blue-500"})}),(0,n.jsx)("h1",{className:"mb-2 text-2xl font-bold text-gray-800",children:"Verifying your email...."}),(0,n.jsx)("p",{className:"text-gray-600",children:"Please wait while we confirm your email address."})]}),"success"===r&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"flex justify-center mb-4",children:(0,n.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-full",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})}),(0,n.jsx)("p",{className:"text-gray-600",children:"Your email has been successfully verified."}),(0,n.jsx)("p",{className:"mt-2 text-blue-600",children:"Redirecting to dashboard..."})]}),"error"===r&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"flex justify-center mb-4",children:(0,n.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-red-100 rounded-full",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})}),(0,n.jsx)("h1",{className:"mb-2 text-2xl font-bold text-gray-800",children:"Verification Failed"}),(0,n.jsx)("p",{className:"text-gray-600",children:a}),(0,n.jsx)("button",{onClick:()=>window.location.href="/login",className:"mt-4 px-4 py-2 font-medium text-white bg-blue-500 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Go to Login"})]})]})})}},9483:(e,r,t)=>{"use strict";t.d(r,{X:()=>n,a:()=>s});let n="access_token",s="refresh_token"}},e=>{var r=r=>e(e.s=r);e.O(0,[464,441,684,358],()=>r(6940)),_N_E=e.O()}]);